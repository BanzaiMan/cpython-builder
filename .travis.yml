language: python

matrix:
  include:
    - sudo: required
      services:
        - docker
      env:
        - RELEASE=trusty
    - sudo: required
      env:
        - RELEASE=precise

env:
  global:
    - VERSION='3.6-dev'
    - ALIAS='nightly'

install:
  - pushd /opt/pyenv/
  - sudo git checkout master
  - sudo git pull
  - popd

before_script:
  - ": ${INSTALL_DEST:=/opt/python}"
  - ": ${LSB_RELEASE:=$(lsb_release -rs)}"
  - ": ${PACKAGES:=pip numpy nose pytest mock wheel}"

script: ./build-python

after_success: ./create-archive

after_failure:
  - cat /tmp/python-build.*.log

addons:
  artifacts:
    paths:
    - $LSB_RELEASE
    target_paths:
    - ""
